<app-navbar></app-navbar>

<body>
  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <img
          [src]="
            '/assets/Recipe_Images/' +
            (recipe.recipe_name?.split(' ')?.join('') || 'default') +
            '.jpg'
          "
          alt="Recipe Image"
          class="img-fluid"
        />
      </div>

      <div class="col-md-8">
        <form>
          <div class="form-group">
            <label for="recipeName" class="font-weight-bold"
              >Name of Recipe</label
            >
            <input
              type="text"
              id="recipeName"
              name="recipe_name"
              class="form-control"
              required
              minlength="3"
              maxlength="50"
              [(ngModel)]="recipe.recipe_name"
              [disabled]="!submitted"
              #recipeName="ngModel"
            />
            <div
              *ngIf="recipeName.invalid && recipeName.touched"
              class="text-danger"
            >
              <small *ngIf="recipeName.errors?.['required']"
                >Recipe name is required.</small
              >
              <small *ngIf="recipeName.errors?.['minlength']"
                >Minimum length is 3 characters.</small
              >
              <small *ngIf="recipeName.errors?.['maxlength']"
                >Maximum length is 50 characters.</small
              >
            </div>
          </div>

          <!-- Meal Timing -->
          <div class="form-group">
            <label for="mealTiming" class="font-weight-bold">Meal Timing</label>
            <select
              id="mealTiming"
              name="meal_timing"
              [(ngModel)]="recipe.meal_timing"
              class="form-control"
              [disabled]="!submitted"
            >
              <option value="">None</option>
              <option *ngFor="let timing of mealTimings" [value]="timing">
                {{ timing }}
              </option>
            </select>
          </div>

          <!-- Meal Type -->
          <div class="form-group">
            <label for="mealType" class="font-weight-bold">Meal Type</label>
            <select
              id="mealType"
              name="meal_type"
              [(ngModel)]="recipe.meal_type"
              class="form-control"
              [disabled]="!submitted"
            >
              <option value="">None</option>
              <option *ngFor="let type of mealTypes" [value]="type">
                {{ type }}
              </option>
            </select>
          </div>

          <!-- Season -->
          <div class="form-group">
            <label for="seasonal" class="font-weight-bold">Season</label>
            <select
              id="seasonal"
              name="seasonal"
              [(ngModel)]="recipe.seasonal"
              class="form-control"
              [disabled]="!submitted"
            >
              <option value="">None</option>
              <option *ngFor="let season of seasons" [value]="season">
                {{ season }}
              </option>
            </select>
          </div>

          <!-- Cuisine -->
          <div class="form-group">
            <label for="cuisine" class="font-weight-bold">Cuisine</label>
            <select
              id="cuisine"
              name="cuisine"
              [(ngModel)]="recipe.cuisine"
              class="form-control"
              [disabled]="!submitted"
            >
              <option value="">None</option>
              <option *ngFor="let cuisine of cuisines" [value]="cuisine">
                {{ cuisine }}
              </option>
            </select>
          </div>

          <!-- Conditional Nutrition Fields -->
          <div *ngIf="isNutritionist" class="form-group">
            <label for="calories" class="font-weight-bold">Calories</label>
            <input
              type="number"
              id="calories"
              name="calories"
              [(ngModel)]="nutrition.calories"
              [disabled]="!submitted"
              class="form-control"
            />
            <label for="protein" class="font-weight-bold">Protein</label>
            <input
              type="number"
              id="protein"
              name="protein"
              [(ngModel)]="nutrition.protein"
              [disabled]="!submitted"
              class="form-control"
            />
            <label for="fat" class="font-weight-bold">Fat</label>
            <input
              type="number"
              id="fat"
              name="fat"
              [(ngModel)]="nutrition.fat"
              [disabled]="!submitted"
              class="form-control"
            />
            <label for="carbs" class="font-weight-bold">Carbohydrates</label>
            <input
              type="number"
              id="carbs"
              name="carbs"
              [(ngModel)]="nutrition.carbs"
              [disabled]="!submitted"
              class="form-control"
            />
          </div>

          <!-- Ingredients -->
          <div class="form-group">
            <label for="ingredients">Ingredients</label>
            <div id="ingredients">
              <div
                class="input-group mb-2"
                *ngFor="let ingredient of recipe.ingredients; let i = index"
              >
                <input
                  type="text"
                  class="form-control"
                  [(ngModel)]="ingredient.name"
                  name="ingredient{{ i }}"
                  [disabled]="!submitted"
                />
              </div>
            </div>
          </div>

          <!-- Recipe Steps -->
          <div class="form-group">
            <label for="recipeSteps" class="font-weight-bold"
              >Preparation Steps</label
            >
            <textarea
              id="recipeSteps"
              name="recipe_steps"
              required
              minlength="10"
              [(ngModel)]="recipe.recipe_steps"
              [disabled]="!submitted"
              class="form-control"
              #recipeSteps="ngModel"
            ></textarea>
            <div
              *ngIf="recipeSteps.invalid && recipeSteps.touched"
              class="text-danger"
            >
              <small *ngIf="recipeSteps.errors?.['required']"
                >Steps are required.</small
              >
              <small *ngIf="recipeSteps.errors?.['minlength']"
                >Minimum 10 characters required.</small
              >
            </div>
          </div>

          <!-- Edit/Update Button -->
          <button
            type="button"
            class="btn btn-secondary"
            (click)="toggleEdit()"
          >
            {{ submitted ? "Update" : "Edit" }}
          </button>
        </form>
      </div>
    </div>
  </div>
</body>

<app-footer></app-footer>
